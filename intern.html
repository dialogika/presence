<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Presensi Internship | Kursus Public Speaking Dialogika</title>
  <meta name="description"
    content="Presensi Khusus Internship Dialogika" />
  <meta name="keywords" content="skill, public speaking, training, kelas, pelatihan, inhouse training" />
  <meta name="author" content="Dialogika" />

  <!-- Favicons -->
  <!-- Font Awesome CDN -->
  <link href="assets/img/favicon.webp" rel="icon">
  <link href="assets/img/apple-touch-icon.webp" rel="apple-touch-icon">

  <!-- OG Meta Tags to share -->
  <meta property="og:site_name" content="Kelas Public Speaking" />
  <meta property="og:site" content="www.dialogika.co" />
  <meta property="og:title" content="Presensi Internship | Kursus Public Speaking Dialogika" />
  <meta property="og:description" content="Presensi Khusus Internship Dialogika" />
  <meta property="og:image" content="assets/img/hero-bg.webp" />
  <meta property="og:url" content="www.dialogika.co/presence" />
  <meta property="og:type" content="page" />

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">


  <!-- Vendor CSS Files -->
  <link href="assets/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" />
  <link href="assets/vendor/animate.css/animate.min.css" rel="stylesheet" />
  <link href="assets/vendor/bootstrap/css/bootstrap.css" rel="stylesheet" />
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet" />
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet" />
  <link href="assets/vendor/swiper/swiper-bundle.css" rel="stylesheet" />
  <link href="assets/vendor/international-phone-number/intlTelInput.css" rel="stylesheet" />


  <!-- Part CSS Files -->
  <link href="assets/part/theme-counter/theme-counter.css" rel="stylesheet" />
  <link href="assets/part/testimoni-insurin/testi.css" rel="stylesheet" />
  <link href="assets/part/about-append/about.css" rel="stylesheet" />
  <link href="assets/part/cta-append/cta.css" rel="stylesheet" />
  <link href="assets/part/contact-append/contact.css" rel="stylesheet" />
  <link href="assets/part/portfolio-insurin/portfolio.css" rel="stylesheet" />
  <link href="assets/part/category/category.css" rel="stylesheet" />
  <link href="assets/part/popup-box/popup.css" rel="stylesheet" />
  <link href="assets/part/modals/modal.css" rel="stylesheet" />
  <link href="assets/part/smooth-slider/smooth-slider.css" rel="stylesheet" />
  <link href="assets/part/read-more/read-more_less.css" rel="stylesheet" />


  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet" />

  <!--  ========================================================  -->
  <!-- Spreadsheet API Form Pendaftaran -->
  <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
    crossorigin="anonymous"></script>
  <script>
    function HeroForm() {
      $.ajax({
        url: "https://api.apispreadsheets.com/data/JYfPTNSLW4GoVohc/",
        type: "post",
        data: $("#HeroForms").serializeArray(),
        headers: {
          accessKey: "6df7b75d348bfbdfa9684dfc76ed0053",
          secretKey: "68a998592183dc30cdc2b07576759f04"
        },
        success: function () {
          alert(" Permintaan telah di submit :)")
        },
        error: function () {
          alert("There was an error :(")
        }
      });
    }

    function SubForm() {
      $.ajax({
        url: "https://api.apispreadsheets.com/data/JYfPTNSLW4GoVohc/",
        type: "post",
        data: $("#myForm").serializeArray(),
        headers: {
          accessKey: "6df7b75d348bfbdfa9684dfc76ed0053",
          secretKey: "68a998592183dc30cdc2b07576759f04"
        },
        success: function () {
          alert("Anda Telah Mendaftar :)")
        },
        error: function () {
          alert("There was an error :(")
        }
      });
    }

    function Subcription() {
      $.ajax({
        url: "https://api.apispreadsheets.com/data/18511/",
        type: "post",
        data: $("#subcriptions").serializeArray(),
        success: function () {
          // $('#subcription-modal').modal('show');
          // open("https://link.dialogika.co/open-whatsapp-group");
          window.location.href = "https://link.dialogika.co/open-whatsapp-group";
        },
        error: function () {
          alert("There was an error :(")
        }
      });
    }
  </script>
  <!-- End Spreadsheet API Form Pendaftaran -->

  <!-- Meta Pixel Code -->
  <script>
    ! function (f, b, e, v, n, t, s) {
      if (f.fbq) return;
      n = f.fbq = function () {
        n.callMethod ?
          n.callMethod.apply(n, arguments) : n.queue.push(arguments)
      };
      if (!f._fbq) f._fbq = n;
      n.push = n;
      n.loaded = !0;
      n.version = '2.0';
      n.queue = [];
      t = b.createElement(e);
      t.async = !0;
      t.src = v;
      s = b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s)
    }(window, document, 'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '916674555903437');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=916674555903437&ev=PageView&noscript=1" /></noscript>
  <!-- End Meta Pixel Code -->

  <!-- Pixel Quora -->
  <!-- DO NOT MODIFY -->
  <!-- Quora Pixel Code (JS Helper) -->
  <script>
    ! function (q, e, v, n, t, s) {
      if (q.qp) return;
      n = q.qp = function () {
        n.qp ? n.qp.apply(n, arguments) : n.queue.push(arguments);
      };
      n.queue = [];
      t = document.createElement(e);
      t.async = !0;
      t.src = v;
      s = document.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t, s);
    }(window, 'script', 'https://a.quora.com/qevents.js');
    qp('init', 'cae6711903da464ab62f03df5f66aedc');
    qp('track', 'ViewContent');
  </script>
  <noscript><img height="1" width="1" style="display:none"
      src="https://q.quora.com/_/ad/cae6711903da464ab62f03df5f66aedc/pixel?tag=ViewContent&noscript=1" /></noscript>
  <!-- End of Quora Pixel Code -->
  <script>
    qp('track', 'GenerateLead');
  </script>
  <!-- End Pixel Quora -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-HV60XT856G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-148836422-2');
    gtag('config', 'G-HV60XT856G');
  </script>
  <!-- End Global site tag (gtag.js) - Google Analytics -->

  <!-- Google Tag Manager -->
  <script>
    (function (w, d, s, l, i) {
      w[l] = w[l] || [];
      w[l].push({
        'gtm.start': new Date().getTime(),
        event: 'gtm.js'
      });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
      j.async = true;
      j.src =
        'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
      f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-KGK9D6H');
  </script>
  <!-- End Google Tag Manager -->

  <!-- Hotjar Tracking Code for https://dialogika.co -->
  <script>
    (function (h, o, t, j, a, r) {
      h.hj = h.hj || function () {
        (h.hj.q = h.hj.q || []).push(arguments)
      };
      h._hjSettings = {
        hjid: 2828594,
        hjsv: 6
      };
      a = o.getElementsByTagName('head')[0];
      r = o.createElement('script');
      r.async = 1;
      r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
      a.appendChild(r);
    })(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
  </script>
  <!-- End Hotjar -->
  <!--  ========================================================  -->
  <style>
          :root {
              --primary-blue: #0B2B6A;
              --accent-gold: #F39C12;
              --bg-light: #fff;
              --success-green: #2ecc71;
          }

          body {
              background-color: var(--bg-light);
              font-family: 'Poppins', sans-serif;
              user-select: none;
          }

          .card-custom {
              max-width: 450px;
              margin: 30px auto;
              border: none;
              border-radius: 20px;
              box-shadow: 0 15px 40px rgba(11, 43, 106, 0.15);
              background: white;
              overflow: hidden;
              position: relative;
              min-height: 400px; /* Agar tampilan stabil */
          }

          /* TAMPILAN BLOCKED (DILUAR JADWAL) */
          .blocked-view {
              display: flex;
              flex-direction: column;
              justify-content: center;
              align-items: center;
              height: 100%;
              padding: 40px;
              text-align: center;
              background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
          }
          .blocked-icon { font-size: 5rem; color: #bdc3c7; margin-bottom: 20px; }
          .blocked-title { color: var(--primary-blue); font-weight: 700; font-size: 1.5rem; margin-bottom: 10px; }
          .blocked-desc { color: #7f8c8d; font-size: 0.9rem; }
          .blocked-time {
              background: #ffeaa7; color: #d35400;
              padding: 5px 15px; border-radius: 50px;
              font-weight: 600; font-size: 0.8rem; margin-top: 15px;
          }

          /* HEADER & FORM */
          .header-bg {
              background: linear-gradient(135deg, var(--primary-blue) 0%, #16438a 100%);
              color: white;
              padding: 30px 20px;
              text-align: center;
              border-bottom: 4px solid var(--accent-gold);
          }

          .card-body { padding: 25px; }

          /* JAM REALTIME */
          .clock-container { text-align: center; margin: 20px 0 10px 0; }
          .clock-time { font-size: 3rem; font-weight: 700; color: var(--primary-blue); line-height: 1; }
          .clock-label { font-size: 0.8rem; color: #888; margin-bottom: 15px; }

          /* SWIPE BUTTON */
          .swipe-container {
              position: relative; width: 100%; height: 60px;
              background: #eef2f7; border-radius: 50px;
              overflow: hidden; border: 1px solid #dce4ec;
              margin-bottom: 20px; cursor: pointer;
          }
          .swipe-text {
              position: absolute; width: 100%; height: 100%;
              display: flex; align-items: center; justify-content: center;
              font-size: 0.9rem; font-weight: 600; color: #888; z-index: 1;
              padding-left: 40px; transition: opacity 0.3s;
          }
          .swipe-handle {
              position: absolute; left: 0; top: 0; width: 60px; height: 60px;
              background: var(--accent-gold); border-radius: 50px;
              display: flex; align-items: center; justify-content: center;
              color: white; font-size: 1.5rem; z-index: 2;
              box-shadow: 0 4px 10px rgba(243, 156, 18, 0.4);
              transition: background 0.3s; cursor: grab;
          }
          .swipe-overlay {
              position: absolute; left: 0; top: 0; height: 100%; width: 0;
              background: var(--success-green); z-index: 1; border-radius: 50px;
          }

          /* IZIN SECTION */
          .izin-trigger { text-align: center; margin-top: 10px; }
          .izin-link { color: #888; font-size: 0.9rem; border-bottom: 1px dashed #ccc; cursor: pointer; }
          .izin-link:hover { color: var(--accent-gold); }
          .izin-form-container {
              max-height: 0; overflow: hidden; transition: all 0.5s ease;
              opacity: 0; margin-top: 0;
          }
          .izin-form-container.active { max-height: 500px; opacity: 1; margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; }
          .btn-izin { background-color: var(--primary-blue); color: white; width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: 600; margin-top: 10px; }

          /* LOADING & UTILS */
          .loading-overlay {
              position: absolute; top: 0; left: 0; width: 100%; height: 100%;
              background: rgba(255,255,255,0.95); z-index: 60;
              display: flex; flex-direction: column;
              justify-content: center; align-items: center;
          }
          .hidden { display: none !important; }
          .form-select { border: 2px solid #e0e0e0; border-radius: 12px; padding: 12px; }
      </style>
</head>

<body>

  <!-- ======= Top Bar, Header, Side Bar ======= -->
  <main-header style=";"></main-header>
  <!-- ======= Top Bar, Header, Side Bar ======= -->

  <!-- ======= Breadcrumbs Section ======= -->
  <section class="breadcrumbs">
    <div class="container">
      <div class="d-flex justify-content-between align-items-center" >
        <h2>Internship Program</h2>
        <ol>
          <li><a href="../index.html">Home</a></li>
          <li><a href="index.html">Presence</a></li>
          <li><a href="intern.html">Internship</a></li>
        </ol>
      </div>

    </div>
  </section><!-- End Breadcrumbs Section -->

  <main id="main">
      <div class="container">
          <div class="card card-custom">

              <!-- 1. TAMPILAN BLOCKED (DEFAULT VISIBLE, JS AKAN HIDE JIKA JADWAL SESUAI) -->
              <div id="blockedView" class="blocked-view">
                  <i class="bi bi-shop-window blocked-icon" id="blockedIcon"></i>
                  <h4 class="blocked-title" id="blockedTitle">MEMUAT...</h4>
                  <p class="blocked-desc" id="blockedDesc">Sedang memeriksa jadwal operasional.</p>
                  <div id="blockedTimeBadge" class="hidden blocked-time"></div>
              </div>

              <!-- 2. TAMPILAN FORM (DEFAULT HIDDEN) -->
              <div id="mainFormView" class="hidden">
                  
                  <!-- Loading Overlay saat Submit -->
                  <div id="loadingOverlay" class="loading-overlay hidden">
                      <div class="spinner-border text-primary mb-3" role="status"></div>
                      <h5 class="fw-bold" style="color:var(--primary-blue)">Mengirim Data...</h5>
                  </div>

                  <!-- Header -->
                  <div class="header-bg">
                      <h4 class="mb-0">PRESENSI INTERN</h4>
                      <small>PT Dialogika Persona Indonesia</small>
                      <div class="mt-3">
                          <span id="dateDisplay" style="background:rgba(255,255,255,0.2); padding:5px 15px; border-radius:50px; font-size:0.85rem">Memuat tanggal...</span>
                      </div>
                  </div>

                  <!-- Body Form -->
                  <div class="card-body">
                      
                      <!-- Dropdown Nama -->
                      <div class="mb-4">
                          <label class="form-label" style="color:var(--primary-blue); font-weight:600">Nama Lengkap</label>
                          <select class="form-select" id="name" required>
                              <option value="" selected disabled>-- Memuat Nama... --</option>
                          </select>
                          <div id="nameLoadingStatus" class="text-muted mt-1" style="font-size:0.8rem">
                              <span class="spinner-border spinner-border-sm" role="status"></span> Sedang mengambil data...
                          </div>
                      </div>

                      <!-- Bagian Hadir (Swipe) -->
                      <div id="hadirSection">
                          <div class="clock-container">
                              <div class="clock-time" id="realTimeClock">--:--</div>
                              <div class="clock-label">Waktu Presensi Saat Ini</div>
                          </div>

                          <div class="swipe-container" id="swipeContainer">
                              <div class="swipe-overlay" id="swipeOverlay"></div>
                              <div class="swipe-text" id="swipeText">SWIPE RIGHT FOR HADIR <i class="bi bi-chevron-double-right ms-2"></i></div>
                              <div class="swipe-handle" id="swipeHandle">
                                  <i class="bi bi-arrow-right"></i>
                              </div>
                          </div>
                      </div>

                      <!-- Bagian Izin -->
                      <div class="izin-trigger">
                          <span class="text-muted small">Tidak bisa hadir?</span><br>
                          <span class="izin-link" onclick="toggleIzinForm()">Klik disini untuk Izin / Sakit</span>
                      </div>

                      <div class="izin-form-container" id="izinContainer">
                          <h6 class="fw-bold mb-3" style="color:var(--accent-gold)">Form Perizinan</h6>
                          <div class="mb-3">
                              <label class="form-label">Alasan / Keterangan</label>
                              <textarea class="form-control" id="reason" rows="3" placeholder="Tuliskan alasan izin..."></textarea>
                          </div>
                          <button type="button" class="btn btn-izin" onclick="submitIzin()">
                              <i class="bi bi-send-fill me-2"></i> KIRIM PERIZINAN
                          </button>
                      </div>
                  </div>
              </div>

          </div>
          
          <div id="alertBox" class="text-center mt-3"></div>
          <div class="text-center pb-5 pt-2">
              <small class="text-muted" style="font-size:0.7rem">&copy; 2025 Dialogika Persona Indonesia</small>
          </div>
      </div>

      <script>
          // ===========================================
          // ðŸ‘‡ UPDATE URL APPS SCRIPT ANDA DISINI ðŸ‘‡
          // ===========================================
          const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwFttNhZ4TrtN2UWBR_z5aE-z1TGjG15Gf-UATwDe9Gefid4Qi5zL_Mv514es9DMS7cyw/exec";
          // ===========================================

          // --- 1. LOGIKA VALIDASI HARI & JAM ---
          function checkSchedule() {
              const now = new Date();
              const day = now.getDay(); // 0=Min, 1=Sen, ...
              const hour = now.getHours();

              const allowedDays = [0, 2, 4, 6]; // Minggu, Selasa, Kamis, Sabtu
              const blockedView = document.getElementById('blockedView');
              const formView = document.getElementById('mainFormView');
              
              const bIcon = document.getElementById('blockedIcon');
              const bTitle = document.getElementById('blockedTitle');
              const bDesc = document.getElementById('blockedDesc');
              const bTime = document.getElementById('blockedTimeBadge');

              // A. Cek Hari
              if (!allowedDays.includes(day)) {
                  bIcon.className = "bi bi-calendar-x blocked-icon";
                  bTitle.innerText = "BUKAN JADWAL PRESENSI";
                  bDesc.innerHTML = "Presensi hanya dibuka pada hari:<br><strong>Selasa, Kamis, Sabtu, & Minggu</strong>";
                  bTime.classList.add('hidden');
                  return false;
              }

              // B. Cek Jam (Buka 08:00 - 15:00)
              // hour < 8 (sebelum jam 8) atau hour >= 15 (jam 15.00 ke atas)
              if (hour < 8 || hour >= 15) {
                  bIcon.className = "bi bi-clock-history blocked-icon";
                  bTitle.innerText = "PRESENSI DITUTUP";
                  
                  if (hour < 8) {
                      bDesc.innerHTML = "Presensi belum dibuka.<br>Silakan kembali nanti.";
                  } else {
                      bDesc.innerHTML = "Waktu presensi hari ini sudah habis.<br>Form ditutup otomatis.";
                  }
                  
                  bTime.innerText = "Jadwal: 08:00 - 15:00 WIB";
                  bTime.classList.remove('hidden');
                  return false;
              }

              // Jika Lolos Semua -> Tampilkan Form
              blockedView.classList.add('hidden');
              formView.classList.remove('hidden');
              return true;
          }

          // --- 2. UPDATE JAM REALTIME ---
          function updateClock() {
              const now = new Date();
              const hh = String(now.getHours()).padStart(2, '0');
              const mm = String(now.getMinutes()).padStart(2, '0');
              
              const clockEl = document.getElementById('realTimeClock');
              if(clockEl) clockEl.innerText = `${hh}:${mm}`;
              
              const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
              const dateEl = document.getElementById('dateDisplay');
              if(dateEl) dateEl.innerText = now.toLocaleDateString('id-ID', options);
          }

          // --- 3. FETCH DATA (INIT) ---
          document.addEventListener("DOMContentLoaded", function() {
              // Cek jadwal dulu saat load
              const isOpen = checkSchedule();
              if (!isOpen) return; // Stop jika tutup

              // Jalankan jam
              setInterval(updateClock, 1000);
              updateClock();

              // Ambil Data Nama
              const nameSelect = document.getElementById('name');
              const statusMsg = document.getElementById('nameLoadingStatus');

              fetch(SCRIPT_URL)
                  .then(res => res.json())
                  .then(data => {
                      nameSelect.innerHTML = '<option value="" selected disabled>-- Pilih Nama Anda --</option>';
                      
                      const allNames = data.allNames || [];
                      const submitted = data.submittedNames || [];

                      let availableCount = 0;

                      if(allNames.length > 0) {
                          allNames.forEach(nama => {
                              // Filter: Jangan tampilkan nama yang sudah absen
                              if (!submitted.includes(nama)) {
                                  const opt = document.createElement('option');
                                  opt.value = nama; opt.text = nama;
                                  nameSelect.appendChild(opt);
                                  availableCount++;
                              }
                          });

                          statusMsg.classList.add('hidden');
                          
                          // Jika semua orang sudah absen
                          if (availableCount === 0) {
                              nameSelect.innerHTML = '<option disabled>Semua intern sudah absen hari ini</option>';
                          }

                      } else {
                          statusMsg.innerText = "Data Kosong.";
                          statusMsg.classList.add('text-danger');
                      }
                  })
                  .catch(err => {
                      console.error(err);
                      statusMsg.innerText = "Gagal koneksi server.";
                  });
          });

          // --- 4. SWIPE LOGIC ---
          const container = document.getElementById('swipeContainer');
          const handle = document.getElementById('swipeHandle');
          const overlay = document.getElementById('swipeOverlay');
          const text = document.getElementById('swipeText');
          let isDragging = false, startX = 0, maxDrag = 0, submitted = false;

          function checkName() {
              if(document.getElementById('name').value === "") {
                  alert("Harap pilih nama Anda terlebih dahulu!");
                  return false;
              }
              return true;
          }

          function startDrag(clientX) {
              if(submitted) return;
              if(!checkName()) return;
              isDragging = true;
              startX = clientX;
              maxDrag = container.offsetWidth - 60;
              handle.style.transition = 'none'; overlay.style.transition = 'none';
          }

          function onDrag(clientX) {
              if(!isDragging || submitted) return;
              let currentX = clientX - startX;
              if(currentX < 0) currentX = 0;
              if(currentX > maxDrag) currentX = maxDrag;
              handle.style.left = currentX + 'px';
              overlay.style.width = (currentX + 30) + 'px';
              text.style.opacity = 1 - (currentX / (maxDrag * 0.8));
          }

          function endDrag() {
              if(!isDragging || submitted) return;
              isDragging = false;
              const currentLeft = parseInt(handle.style.left || 0);
              if(currentLeft >= maxDrag * 0.85) {
                  submitted = true;
                  handle.style.left = maxDrag + 'px';
                  overlay.style.width = '100%';
                  handle.innerHTML = '<i class="bi bi-check-lg"></i>';
                  handle.style.backgroundColor = '#2ecc71';
                  text.innerText = "TERKIRIM!"; text.style.opacity = 1; text.style.color = "white";
                  submitData('Hadir');
              } else {
                  handle.style.transition = 'left 0.3s ease, background 0.3s';
                  overlay.style.transition = 'width 0.3s ease';
                  handle.style.left = '0px'; overlay.style.width = '0px';
                  text.style.opacity = 1;
              }
          }

          // Mouse & Touch Events
          if(handle) {
              handle.addEventListener('mousedown', (e) => startDrag(e.clientX));
              document.addEventListener('mousemove', (e) => onDrag(e.clientX));
              document.addEventListener('mouseup', endDrag);
              handle.addEventListener('touchstart', (e) => startDrag(e.touches[0].clientX));
              document.addEventListener('touchmove', (e) => onDrag(e.touches[0].clientX));
              document.addEventListener('touchend', endDrag);
          }

          // --- 5. SUBMIT & IZIN ---
          function toggleIzinForm() {
              document.getElementById('izinContainer').classList.toggle('active');
          }

          function submitIzin() {
              if(!checkName()) return;
              const reason = document.getElementById('reason').value;
              if(reason.trim() === "") { alert("Isi alasan izin!"); return; }
              submitData('Izin', reason);
          }

          function submitData(status, reasonVal = "-") {
              document.getElementById('loadingOverlay').classList.remove('hidden');
              const name = document.getElementById('name').value;
              const now = new Date();
              const dateFormatted = now.toLocaleDateString('id-ID', { day:'2-digit', month:'2-digit', year:'numeric' });
              
              let timeVal = "-";
              if(status === 'Hadir') {
                  const hh = String(now.getHours()).padStart(2, '0');
                  const mm = String(now.getMinutes()).padStart(2, '0');
                  timeVal = `${hh}:${mm}`;
              }

              const payload = {
                  name: name,
                  date: dateFormatted,
                  time: timeVal,
                  status: status,
                  reason: reasonVal
              };

              fetch(SCRIPT_URL, {
                  method: 'POST',
                  body: JSON.stringify(payload)
              })
              .then(res => res.json())
              .then(data => {
                  document.getElementById('loadingOverlay').classList.add('hidden');
                  if(data.result === 'success') {
                      document.querySelector('.card-body').innerHTML = `
                          <div class="text-center py-5">
                              <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
                              <h3 class="fw-bold mt-3" style="color:var(--primary-blue)">Berhasil!</h3>
                              <p class="text-muted">Data presensi tersimpan.</p>
                              <button onclick="location.reload()" class="btn btn-outline-primary mt-3 btn-sm">Kembali</button>
                          </div>`;
                  } else {
                      alert("Gagal: " + data.error);
                      if(status === 'Hadir') location.reload();
                  }
              })
              .catch(err => {
                  document.getElementById('loadingOverlay').classList.add('hidden');
                  alert("Error koneksi.");
                  if(status === 'Hadir') location.reload();
              });
          }
      </script>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
      
  </main><!-- End #main -->

  <!-- ======= Footer & Counter Area ======= -->
  <main-footer></main-footer>
  <!-- ======= End Footer & Counter Area ======= -->

  <footer-modal></footer-modal>

  <a href="#exampleModal" data-bs-toggle="modal" class="back-to-top d-flex align-items-center justify-content-center"><i
      class="bx bxl-whatsapp bx-tada"></i></a>

  <!-- Modal 2 -->
  <div class="modal popup-box fade" id="exampleModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog popup-box-dialog modal-dialog-centered">
      <div class="modal-content popup-box-content">
        <div class="popup-card" style="width:100%">
          <button type="button" class="btn popup2-btn ms-auto" data-bs-dismiss="modal"><i
              class="fa-solid fa-xmark"></i></button>
          <img src="assets/img/shape/popup.jpg" class="card-img-top" alt=""
            style="border-top-left-radius: 20px;border-top-right-radius: 20px;border:0px;">
          <div class="card-body popup-card-body">

          </div>
          <form action="javascript:void" method="post" id="heroForm" enctype="text/plain" class="popup-form">
            <div class="row gy-3 mb-3">
              <div class="col-lg-6">
                <label for="names" class="form-label">Full Name</label>
                <input type="text" name="Name" class="form-control" id="names" pattern="[a-zA-Z\s]{3,100}"
                  placeholder="Nama Lengkap*" required>
              </div>
              <div class="col-lg-6">
                <label for="locations" class="form-label">Lokasi</label>
                <input type="text" class="form-control" name="Location" id="locations" pattern="[a-zA-Z\s]{3,100}"
                  placeholder="Kota*" required>
              </div>
              <div class="col-lg-6">
                <label for="whatsapps" class="form-label">Whatsapp</label>
                <input type="tel" class="form-control" name="Whatsapp" id="whatsapps" pattern="[0-9]{10,15}"
                  placeholder="Whatsapp*" required="">
              </div>
              <div class="col-lg-6">
                <label for="events" class="form-label">Needs</label>
                <input type="text" name="Event" class="form-control" id="events" placeholder="Kebutuhan">
              </div>
              <select class="d-none" name="Timestamp">
                <option id="timestamp"></option>
              </select>
            </div>
            <button class="custom-btn2 send_contact" id="submits" onclick="HeroForm()">Send Whatsapp</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Part JS Files -->
  <script src="assets/part/modals/modal-component.js"></script>
  <script src="assets/part/smooth-slider/smooth-slider.js"></script>
  <script src="assets/part/whatsapp/whatsapp.js"></script>
  <script src="assets/part/read-more/read-more_less.js"></script>


  <!-- Vendor JS Files -->
  <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/international-phone-number/script.js"></script>
  <script src="assets/vendor/international-phone-number/intlTelInput.min.js"></script>


  <!-- Template Main JS File -->
  <script src="assets/js/headerfooter.js"></script>
  <script src="assets/js/timestamp.js"></script>
  <!-- <script src="assets/js/whatsapp.js"></script> -->
  <script src="assets/js/clickup-task.js"></script>
  <script src="assets/js/main.js"></script>


</body>

</html>
